<!doctype html>
<html>
  <head>
    <title>Scope as a Service - Users</title>
  </head>
  <body>
    <h2>Accounts</h2>
    <span>
      Showing:
      {{if or .ShowingApproved .ShowingUnapproved}}<a href="users">All</a>{{else}}All{{end}}
      {{if .ShowingApproved}}Approved{{else}}<a href="users?approved=true">Approved</a>{{end}}
      {{if .ShowingUnapproved}}Unapproved{{else}}<a href="users?approved=false">Unapproved</a>{{end}}
    </span>
    {{with .}}
    <table>
      <tr>
        <th>Email</th>
        <th>CreatedAt</th>
        <th>ApprovedAt</th>
        <th>FirstLoginAt</th>
        <th>Admin</th>
      </tr>
      {{range .Users}}
      <tr>
        <td>{{.Email}}</td>
        <td>{{.FormatCreatedAt}}</td>
        <td>
          {{if .IsApproved}}
          {{.FormatApprovedAt}}
          {{else}}
          <form action="users/{{.ID}}/approve" method="POST">
            <input type="hidden" name="redirect_to" value="users{{if $.ShowingApproved}}?approved=true{{else if $.ShowingUnapproved}}?approved=false{{end}}" />
            <input type="submit" value="Approve" />
          </form>
          {{end}}
        </td>
        <td>{{.FormatFirstLoginAt}}</td>
        <td>
          {{if .Admin}}
          <input type="checkbox" name="admin" disabled value="true" checked/></td>
          {{else}}
          <form action="users/{{.ID}}/admin" method="POST">
            <input type="hidden" name="redirect_to" value="users{{if $.ShowingApproved}}?approved=true{{else if $.ShowingUnapproved}}?approved=false{{end}}" />
            <input type="submit" value="Make Admin" />
          </form>
          {{end}}
        </td>
      </tr>
      {{end}}
    </table>
    {{else}}
    <p>No users.</p>
    {{end}}
  </body>
</html>
