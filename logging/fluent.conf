<source>
  @type forward
  port 24224
  bind 127.0.0.1
</source>	

<match events>
   @type bigquery
   # We should move to loads and increase flush intervals
   # once we reach a considerable event rate
   method insert

   # buffering
   buffer_type file
   buffer_path /var/log/bigquery.*.buffer
   flush_interval 0.25
   try_flush_interval 0.05
   flush_at_shutdown true
   utc
   # Buffer up to 5GB worth of data (1MB*5000).
   # Assuming a maximum of 2KB per event that should be around 1.5 million (500*5000) events.
   # At a rate of 100 events/second this should give us ~7 hours of buffering.
   buffer_chunk_limit 1m
   buffer_queue_limit 5000


   auth_method json_key
   json_key /bigquery/secret/key.json

   project weaveworks-bi
   dataset service
   table events
   schema_path /bigquery/schema_service_events.json

   time_field   dt
   time_format  %s
</match>
